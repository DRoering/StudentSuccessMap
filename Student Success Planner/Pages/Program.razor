@page "/colleges/departments/programs/success-map"

@using Student_Success_Planner.Data
@inject BreadcrumbService breadcrumbService
@inject NavigationManager navigationManager

@if (!canLoadSuccessMap)
{
    //Need try catch block to avoid exception sometimes thrown during this method call
    try
    {
        //Return to programs page
        navigationManager.NavigateTo(navigationManager.BaseUri + "colleges/departments/programs");
    }
    catch (Exception e)
    {
        Console.Write(e);
    }
}
else
{
    <Breadcrumb>
        <BreadcrumbItem>
            <BreadcrumbLink @onclick="breadcrumbService.handleCollegeDeselection" To="/colleges">Colleges and Schools</BreadcrumbLink>
        </BreadcrumbItem>
        <BreadcrumbItem>
            <BreadcrumbLink @onclick="breadcrumbService.handleDepartmentDeselection" To="/colleges/departments">@breadcrumbService.selectedCollege.getAbbreviation()</BreadcrumbLink>
        </BreadcrumbItem>
        <BreadcrumbItem>
            <BreadcrumbLink @onclick="breadcrumbService.handleProgramDeselection" To="/colleges/departments/programs">@breadcrumbService.selectedDepartment.getName()</BreadcrumbLink>
        </BreadcrumbItem>
        <BreadcrumbItem IsActive="true">
            <BreadcrumbLink To="/colleges/departments/programs/success-map">@breadcrumbService.selectedProgram.getName()</BreadcrumbLink>
        </BreadcrumbItem>
    </Breadcrumb>

    <SuccessMap></SuccessMap>
}

@code {
    /// <summary>
    /// Determines if the success map can be loaded.
    /// </summary>
    private bool canLoadSuccessMap
    {
        get
        {
            return breadcrumbService.selectedCollege != null && breadcrumbService.selectedDepartment != null &&
            breadcrumbService.selectedProgram != null;
        }
    }
}